!function(e){checkLog()||e.location.replace("./errlogin")}(window),function(u,e){u(e).ready(function(){function p(e){checkLog()?(e(),setCookie("user",userNameCookie,.5)):win.location.replace("./errlogin")}var i;u("#uploadbtn").click(function(e){e.preventDefault(),p(function(){var e=u("input[name='padding']").val(),n=u("input[name='bgcolor']").val(),t=u("input[name='imgname']").val(),o=u("input[name='folder']").val(),a=u("input[name='cname']").val();i&&0<=e&&n&&t&&o&&a?(u(".loader").css("display","table"),function(e,n,t,o,a,i){u.post("./createsprites/create",{picType:e,padding:n,bgdColor:t,imgName:o,folder:a,className:i},function(){console.log("post sent")}).done(function(e){"ok"!=e?console.log(e):setTimeout(function(){window.location="./spritescreated"},1e3)})}(i,e,n,t,o,a)):alert("You must define your sprites first!")})}),u("#uploadfiles").val("").change();function c(e){this.file=e}var d=0;c.prototype.getType=function(){return this.file.type},c.prototype.getSize=function(){return this.file.size},c.prototype.getName=function(){return this.file.name},c.prototype.doUpload=function(){var o=this,e=new FormData;try{e.append("file",o.file,o.getName()),e.append("upload_file",!0)}catch(e){console.log(e)}u.ajax({type:"POST",url:"./createsprites/upload",xhr:function(){var e=u.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",o.progressHandling,!1),e},success:function(e){var n=unescape(o.getName()).trim(),t=u("<img>",{attr:{alt:"",src:"./uploads/"+unescape(userNameCookie)+"/uploads/"+n}}).load(function(){console.log("Pic uploaded"),u(this).parent().find(".loading").fadeOut(300)});u(".upcont").each(function(){var e=u(this);e.find(".imgname").html()===n&&e.find(".imgcont").append(t)}),console.log("Pic upload Complete!",d,e),d++},error:function(e){console.log(e)},async:!0,data:e,cache:!1,contentType:!1,processData:!1,timeout:6e3}).done(function(e){console.log(e)})},c.prototype.progressHandling=function(e){var n=0,t=e.loaded||e.position,o=e.total,a="#progress-wrp";e.lengthComputable&&(n=Math.ceil(t/o*100)),u(a+" .progress-bar").css("width",+n+"%"),u(a+" .status").text(n+"%")},u("#upload input").on("change",function(){u("#progress-wrp .progress-bar").remove(),u("#progress-wrp").append('<div class="progress-bar"></div>'),u("#progress-wrp .status").text("0%");var e=u(this)[0].files;for(var n in e){new c(e[n]).doUpload()}for(var t=d,o=document.getElementById("uploadfiles"),a=d;a<o.files.length+t;a++){var i=a-d,r=u("<div>",{addClass:"upcont upcont"+a}),s=u("<div>",{addClass:"remove",click:function(){var o;o=this,p(function(){var e=u(o),n=e.parent(),t=n.find(".imgname").html();n.remove(),u.ajax({type:"POST",url:"./createsprites/removeimg",data:{removePic:t},success:function(e){console.log(e)},error:function(e){console.log(e)}})})},attr:{title:"delete picture"}}),l=u("<div>",{addClass:"rename",click:function(){var s;s=this,p(function(){var e=u(s),n=e.parent(),t=n.find(".imgname").html(),o=t.split(".")[0],a=t.split(".")[1],i=prompt("Rename?",o);if(null!=i&&0<i.length){var r=i+"."+a;n.find(".imgname").html(r),u.ajax({type:"POST",url:"./createsprites/renameimg",data:{oldName:t,newName:r},success:function(e){console.log(e)},error:function(e){console.log(e)}})}})},html:"Rename"});r.append(s),r.append('<div class="imgcont"><div class="loading"><img src="./images/ajax-loader.gif" alt=""></div></div>'),r.append('<p class="imgname">'+o.files[i].name+"</p>"),r.append(l),r.append('<p class="imgtype">'+o.files[i].type+"</p>"),u("#uploaded").append(r)}}),u("input[type='radio']").on("change",function(){var e=u(this).val();!function(t){u(".upcont").each(function(){var e=u(this),n=e.find(".imgtype").html().split("/")[1];n===t?e.removeClass("notaval"):e.addClass("notaval")})}(e),i=e})})}(jQuery,document);